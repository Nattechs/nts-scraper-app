<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - NTS Scraper</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            /* Theme variables will be set by JavaScript */
            --primary-color: #4361ee;
            --secondary-color: #3f37c9;
            --accent-color: #4895ef;
            --background-color: #f8f9fa;
            --text-color: #212529;
            --card-bg: #ffffff;
            --border-color: #dee2e6;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        .navbar {
            background-color: var(--primary-color);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .navbar-brand {
            font-weight: 700;
            color: white !important;
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.85) !important;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            color: white !important;
            transform: translateY(-2px);
        }
        
        .active {
            color: white !important;
            border-bottom: 2px solid white;
        }
        
        .page-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 0;
            border-radius: 0 0 20px 20px;
            margin-bottom: 2rem;
        }
        
        .main-content {
            flex: 1;
        }
        
        .card {
            background-color: var(--card-bg);
            border-color: var(--border-color);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 1.5rem;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 15px 15px 0 0 !important;
            font-weight: 600;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            padding: 0.5rem 1.5rem;
            font-weight: 500;
            border-radius: 50px;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
        }
        
        .form-control, .form-select {
            background-color: var(--card-bg);
            border-color: var(--border-color);
            color: var(--text-color);
            border-radius: 50px;
            padding: 0.75rem 1.5rem;
            transition: all 0.3s ease;
        }
        
        .form-control:focus, .form-select:focus {
            background-color: var(--card-bg);
            border-color: var(--primary-color);
            color: var(--text-color);
            box-shadow: 0 0 0 0.25rem rgba(67, 97, 238, 0.25);
        }
        
        .form-check-input:checked {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .form-switch .form-check-input {
            width: 3em;
            height: 1.5em;
        }
        
        .form-switch .form-check-input:focus {
            border-color: rgba(0, 0, 0, 0.25);
            box-shadow: 0 0 0 0.25rem rgba(67, 97, 238, 0.25);
        }
        
        .footer {
            background-color: var(--dark-color);
            color: white;
            padding: 1.5rem 0;
            margin-top: 2rem;
        }
        
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1100;
        }
        
        .custom-toast {
            background-color: white;
            color: var(--dark-color);
            border-left: 4px solid var(--primary-color);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .settings-icon {
            font-size: 1.5rem;
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary-color);
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin-right: 1rem;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .page-header {
                padding: 1.5rem 0;
            }
        }
        
        /* Dark theme specific styles */
        [data-theme="dark"] .form-control::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        [data-theme="dark"] .form-select option {
            background-color: var(--card-bg);
            color: var(--text-color);
        }
        
        [data-theme="dark"] .text-muted {
            color: rgba(255, 255, 255, 0.6) !important;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-search me-2"></i>NTS Scraper
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="settings">Settings</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="contact">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1 class="display-5 fw-bold"><i class="fas fa-cog me-3"></i>Settings</h1>
            <p class="lead">Configure your scraping preferences and options</p>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container main-content">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <!-- Scraping Settings -->
                <div class="card">
                    <div class="card-header py-3">
                        <h5 class="mb-0"><i class="fas fa-sliders-h me-2"></i>Scraping Settings</h5>
                    </div>
                    <div class="card-body">
                        <form id="scrapingSettingsForm">
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-globe"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Default Scan Depth</label>
                                    <select class="form-select" id="defaultScanDepth">
                                        <option value="1">Level 1 - Homepage Only</option>
                                        <option value="2" selected>Level 2 - Homepage + Linked Pages</option>
                                        <option value="3">Level 3 - Deep Scan</option>
                                    </select>
                                    <div class="form-text">Set the default depth level for website scanning</div>
                                </div>
                            </div>
                            
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-tachometer-alt"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Page Limit</label>
                                    <input type="range" class="form-range" id="pageLimit" min="10" max="100" step="10" value="50">
                                    <div class="d-flex justify-content-between">
                                        <span>10</span>
                                        <span id="pageLimitValue">50</span>
                                        <span>100</span>
                                    </div>
                                    <div class="form-text">Maximum number of pages to scan in a single website</div>
                                </div>
                            </div>
                            
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-filter"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Email Validation</label>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="validateEmails" checked>
                                        <label class="form-check-label" for="validateEmails">
                                            Validate email formats
                                        </label>
                                    </div>
                                    <div class="form-text">Filter out invalid email formats from results</div>
                                </div>
                            </div>
                            
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-phone"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Phone Number Format</label>
                                    <select class="form-select" id="phoneFormat">
                                        <option value="all" selected>All Formats</option>
                                        <option value="international">International Format Only</option>
                                        <option value="local">Local Format Only</option>
                                    </select>
                                    <div class="form-text">Choose which phone number formats to detect</div>
                                </div>
                            </div>
                            
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-link"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Follow External Links</label>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="followExternalLinks">
                                        <label class="form-check-label" for="followExternalLinks">
                                            Follow links to external websites
                                        </label>
                                    </div>
                                    <div class="form-text">Enable to follow links that lead to other domains</div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Display Settings -->
                <div class="card">
                    <div class="card-header py-3">
                        <h5 class="mb-0"><i class="fas fa-desktop me-2"></i>Display Settings</h5>
                    </div>
                    <div class="card-body">
                        <form id="displaySettingsForm">
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-sort-amount-down"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Results Sorting</label>
                                    <select class="form-select" id="resultsSorting">
                                        <option value="type" selected>Group by Type (Emails/Phones)</option>
                                        <option value="source">Group by Source URL</option>
                                        <option value="alphabetical">Alphabetical Order</option>
                                    </select>
                                    <div class="form-text">Choose how results are sorted in the display</div>
                                </div>
                            </div>
                            
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-eye"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Show Source URLs</label>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="showSourceUrls" checked>
                                        <label class="form-check-label" for="showSourceUrls">
                                            Display source URL for each result
                                        </label>
                                    </div>
                                    <div class="form-text">Show which page each email or phone number was found on</div>
                                </div>
                            </div>
                            
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-clone"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Remove Duplicates</label>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="removeDuplicates" checked>
                                        <label class="form-check-label" for="removeDuplicates">
                                            Automatically remove duplicate results
                                        </label>
                                    </div>
                                    <div class="form-text">Filter out duplicate emails and phone numbers</div>
                                </div>
                            </div>
                            
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-palette"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Theme</label>
                                    <select class="form-select" id="themeSelect">
                                        <option value="light" selected>Light</option>
                                        <option value="dark">Dark</option>
                                        <option value="system">System Default</option>
                                    </select>
                                    <div class="form-text">Choose your preferred color theme</div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Export Settings -->
                <div class="card">
                    <div class="card-header py-3">
                        <h5 class="mb-0"><i class="fas fa-file-export me-2"></i>Export Settings</h5>
                    </div>
                    <div class="card-body">
                        <form id="exportSettingsForm">
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Default Export Format</label>
                                    <select class="form-select" id="exportFormat">
                                        <option value="csv" selected>CSV</option>
                                        <option value="json">JSON</option>
                                        <option value="txt">Plain Text</option>
                                        <option value="xlsx">Excel (XLSX)</option>
                                    </select>
                                    <div class="form-text">Choose the default file format for exporting results</div>
                                </div>
                            </div>
                            
                            <div class="mb-4 d-flex align-items-center">
                                <div class="settings-icon">
                                    <i class="fas fa-columns"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="form-label fw-bold">Include Source URLs in Export</label>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="includeSourceInExport" checked>
                                        <label class="form-check-label" for="includeSourceInExport">
                                            Include source URL in exported files
                                        </label>
                                    </div>
                                    <div class="form-text">Add the source URL for each result in exported files</div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Save Button -->
                <div class="text-center mt-4 mb-5">
                    <button type="button" class="btn btn-primary btn-lg px-5" id="saveSettingsBtn">
                        <i class="fas fa-save me-2"></i>Save Settings
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container">
        <div class="toast custom-toast" id="saveToast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <i class="fas fa-check-circle text-success me-2"></i>
                <strong class="me-auto">Success</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                Settings saved successfully!
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <p class="mb-0">Copyright 2025, all rights reserved</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="mb-0">Built By: NATTECHS NG</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/config.js"></script>
    <script>
        // DOM elements
        const pageLimitInput = document.getElementById('pageLimit');
        const pageLimitValue = document.getElementById('pageLimitValue');
        const saveSettingsBtn = document.getElementById('saveSettingsBtn');
        const saveToast = document.getElementById('saveToast');
        const themeSelect = document.getElementById('themeSelect');
        
        // Initialize Bootstrap toast
        const toast = new bootstrap.Toast(saveToast);
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved settings
            loadSettings();
            
            // Update page limit value display
            pageLimitInput.addEventListener('input', function() {
                pageLimitValue.textContent = this.value;
            });
            
            // Theme selection change
            themeSelect.addEventListener('change', function() {
                const selectedTheme = this.value;
                console.log('Theme selected:', selectedTheme); // Debug log
                
                if (selectedTheme === 'system') {
                    const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                    console.log('Applying system theme:', systemTheme); // Debug log
                    setTheme(systemTheme);
                } else {
                    console.log('Applying selected theme:', selectedTheme); // Debug log
                    setTheme(selectedTheme);
                }
                
                // Save the theme preference
                localStorage.setItem('ntsScraperTheme', selectedTheme);
            });
            
            // Save settings button
            saveSettingsBtn.addEventListener('click', saveSettings);
        });
        
        // Load settings from localStorage
        function loadSettings() {
            // Scraping settings
            const scrapingSettings = JSON.parse(localStorage.getItem('ntsScraperScrapingSettings')) || {};
            document.getElementById('defaultScanDepth').value = scrapingSettings.defaultScanDepth || '2';
            document.getElementById('pageLimit').value = scrapingSettings.pageLimit || '50';
            pageLimitValue.textContent = scrapingSettings.pageLimit || '50';
            document.getElementById('validateEmails').checked = scrapingSettings.validateEmails !== false;
            document.getElementById('phoneFormat').value = scrapingSettings.phoneFormat || 'all';
            document.getElementById('followExternalLinks').checked = scrapingSettings.followExternalLinks || false;
            
            // Display settings
            const displaySettings = JSON.parse(localStorage.getItem('ntsScraperDisplaySettings')) || {};
            document.getElementById('resultsSorting').value = displaySettings.resultsSorting || 'type';
            document.getElementById('showSourceUrls').checked = displaySettings.showSourceUrls !== false;
            document.getElementById('removeDuplicates').checked = displaySettings.removeDuplicates !== false;
            document.getElementById('themeSelect').value = displaySettings.theme || 'light';
            
            // Export settings
            const exportSettings = JSON.parse(localStorage.getItem('ntsScraperExportSettings')) || {};
            document.getElementById('exportFormat').value = exportSettings.exportFormat || 'csv';
            document.getElementById('includeSourceInExport').checked = exportSettings.includeSourceInExport !== false;
        }
        
        // Save settings to localStorage
        function saveSettings() {
            // Scraping settings
            const scrapingSettings = {
                defaultScanDepth: document.getElementById('defaultScanDepth').value,
                pageLimit: document.getElementById('pageLimit').value,
                validateEmails: document.getElementById('validateEmails').checked,
                phoneFormat: document.getElementById('phoneFormat').value,
                followExternalLinks: document.getElementById('followExternalLinks').checked
            };
            localStorage.setItem('ntsScraperScrapingSettings', JSON.stringify(scrapingSettings));
            
            // Display settings
            const displaySettings = {
                resultsSorting: document.getElementById('resultsSorting').value,
                showSourceUrls: document.getElementById('showSourceUrls').checked,
                removeDuplicates: document.getElementById('removeDuplicates').checked,
                theme: document.getElementById('themeSelect').value
            };
            localStorage.setItem('ntsScraperDisplaySettings', JSON.stringify(displaySettings));
            
            // Export settings
            const exportSettings = {
                exportFormat: document.getElementById('exportFormat').value,
                includeSourceInExport: document.getElementById('includeSourceInExport').checked
            };
            localStorage.setItem('ntsScraperExportSettings', JSON.stringify(exportSettings));
            
            // Show success toast
            toast.show();
        }
        
        // Navigation function
        function navigateTo(page) {
            window.location.href = `${page}`;
        }
    </script>
</body>
</html>